<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Editar Tarea - Taskly</title>
  <link rel="stylesheet" href="../styles/base.css">
  <link rel="stylesheet" href="../styles/navbar.css">
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar">
    <div class="nav-brand">
      <img src="/taskly-logo.png" alt="Taskly Logo" class="logo-nav">
      <span class="brand-text">Taskly</span>
    </div>

    <!-- Bot√≥n hamburguesa -->
    <button class="nav-toggle" id="nav-toggle" aria-label="Abrir men√∫">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <!-- Links -->
    <div class="nav-links" id="nav-content">
      <a href="#/">Inicio</a>
      <a href="#/tasks">Tareas</a>
      <a href="#/profile">Mi perfil</a>
    </div>
  </nav>

  <!-- Contenido principal -->
  <div class="edit-task-page">
    <div class="edit-task-container">
      <!-- Header -->
      <div class="edit-task-header">
        <h2>‚úèÔ∏è Editar Tarea</h2>
        <p class="edit-task-subtitle">Modifica los detalles de tu tarea</p>
      </div>

      <!-- Formulario -->
      <form id="editTaskForm" class="edit-task-form">
        <!-- T√≠tulo -->
        <div class="form-group">
          <label for="titulo">
            <span class="label-icon">üìù</span>
            T√≠tulo de la tarea
          </label>
          <input 
            type="text" 
            id="titulo" 
            name="titulo"
            placeholder="Ej: Revisar documentos del proyecto" 
            required
          >
        </div>

        <!-- Descripci√≥n -->
        <div class="form-group">
          <label for="descripcion">
            <span class="label-icon">üìÑ</span>
            Descripci√≥n
          </label>
          <textarea 
            id="descripcion" 
            name="descripcion"
            placeholder="Describe los detalles de la tarea..."
            rows="4"
          ></textarea>
        </div>

        <!-- Fecha l√≠mite y Prioridad en una fila -->
        <div class="form-row">
          <div class="form-group half-width">
            <label for="fechaLimite">
              <span class="label-icon">üìÖ</span>
              Fecha l√≠mite
            </label>
            <input 
              type="date" 
              id="fechaLimite" 
              name="fechaLimite"
            >
          </div>

          <div class="form-group half-width">
            <label for="prioridad">
              <span class="label-icon">‚ö°</span>
              Prioridad
            </label>
            <select id="prioridad" name="prioridad">
              <option value="baja">üü¢ Baja</option>
              <option value="media">üü° Media</option>
              <option value="alta">üî¥ Alta</option>
            </select>
          </div>
        </div>

        <!-- Estado -->
        <div class="form-group">
          <label for="estado">
            <span class="label-icon">üìä</span>
            Estado actual
          </label>
          <select id="estado" name="estado">
            <option value="nuevo">üÜï Nuevo</option>
            <option value="en-progreso">‚è≥ En progreso</option>
            <option value="hecho">‚úÖ Completado</option>
          </select>
        </div>

        <!-- Mensaje de estado -->
        <div id="edit-task-message" class="form-message" style="display: none;"></div>

        <!-- Botones de acci√≥n -->
        <div class="form-actions">
          <button type="button" class="btn-secondary" onclick="history.back()">
            <span class="btn-icon">‚Ü©Ô∏è</span>
            Cancelar
          </button>
          <button type="submit" class="btn-primary">
            <span class="btn-icon">üíæ</span>
            Guardar cambios
          </button>
        </div>
      </form>
    </div>
  </div>

  <style>
    /* Variables espec√≠ficas para esta p√°gina */
    :root {
      --edit-task-bg: linear-gradient(135deg, #512383, #3a1e3b);
      --form-bg: rgba(255, 255, 255, 0.95);
      --form-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      --input-focus: rgba(94, 36, 145, 0.3);
      --success-color: #28a745;
      --error-color: #dc3545;
      --warning-color: #ffc107;
    }

    /* Layout principal */
    .edit-task-page {
      min-height: 100vh;
      background: var(--edit-task-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem 1rem;
      position: relative;
    }

    .edit-task-page::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
      pointer-events: none;
    }

    /* Contenedor del formulario */
    .edit-task-container {
      background: var(--form-bg);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      box-shadow: var(--form-shadow);
      padding: 2.5rem;
      width: 100%;
      max-width: 600px;
      position: relative;
      z-index: 1;
      animation: slideInUp 0.6s ease-out;
    }

    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Header del formulario */
    .edit-task-header {
      text-align: center;
      margin-bottom: 2rem;
      padding-bottom: 1.5rem;
      border-bottom: 2px solid rgba(94, 36, 145, 0.1);
    }

    .edit-task-header h2 {
      color: var(--color-primary);
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .edit-task-subtitle {
      color: #666;
      font-size: 1rem;
      margin: 0;
      opacity: 0.8;
    }

    /* Formulario */
    .edit-task-form {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    /* Grupos de formulario */
    .form-group {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .form-group label {
      font-weight: 600;
      color: var(--color-primary);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.95rem;
    }

    .label-icon {
      font-size: 1.1rem;
    }

    /* Fila de formulario */
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
    }

    .half-width {
      width: 100%;
    }

    /* Inputs y selects */
    .form-group input,
    .form-group textarea,
    .form-group select {
      padding: 0.875rem 1rem;
      border: 2px solid #e1e5e9;
      border-radius: 12px;
      font-size: 1rem;
      transition: all 0.3s ease;
      background: white;
      color: #333;
    }

    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px var(--input-focus);
      transform: translateY(-1px);
    }

    .form-group textarea {
      resize: vertical;
      min-height: 100px;
    }

    /* Mensaje de estado */
    .form-message {
      padding: 1rem;
      border-radius: 8px;
      text-align: center;
      font-weight: 500;
      margin: 0.5rem 0;
    }

    .form-message.success {
      background: rgba(40, 167, 69, 0.1);
      color: var(--success-color);
      border: 1px solid rgba(40, 167, 69, 0.3);
    }

    .form-message.error {
      background: rgba(220, 53, 69, 0.1);
      color: var(--error-color);
      border: 1px solid rgba(220, 53, 69, 0.3);
    }

    /* Botones de acci√≥n */
    .form-actions {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
      justify-content: flex-end;
    }

    .btn-primary,
    .btn-secondary {
      padding: 0.875rem 1.5rem;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      min-width: 140px;
      justify-content: center;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--color-primary), var(--color-primary-hover));
      color: white;
      box-shadow: 0 4px 15px rgba(94, 36, 145, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(94, 36, 145, 0.4);
    }

    .btn-secondary {
      background: #f8f9fa;
      color: #666;
      border: 2px solid #e1e5e9;
    }

    .btn-secondary:hover {
      background: #e9ecef;
      transform: translateY(-1px);
    }

    .btn-icon {
      font-size: 1.1rem;
    }

    /* Navbar brand */
    .nav-brand {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .brand-text {
      font-weight: 700;
      font-size: 1.2rem;
      color: white;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .edit-task-container {
        margin: 1rem;
        padding: 2rem 1.5rem;
      }

      .form-row {
        grid-template-columns: 1fr;
        gap: 1rem;
      }

      .form-actions {
        flex-direction: column-reverse;
      }

      .btn-primary,
      .btn-secondary {
        width: 100%;
      }

      .edit-task-header h2 {
        font-size: 1.5rem;
      }
    }

    @media (max-width: 480px) {
      .edit-task-page {
        padding: 1rem 0.5rem;
      }

      .edit-task-container {
        padding: 1.5rem 1rem;
      }
    }
  </style>

  <script>
    // Funcionalidad del formulario de editar tarea
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('editTaskForm');
      const message = document.getElementById('edit-task-message');
      
      // Cargar datos de la tarea si viene por URL
      loadTaskData();
      
      // Manejar env√≠o del formulario
      form.addEventListener('submit', handleFormSubmit);
      
      // Configurar navbar
      setupNavbar();
    });

    // Cargar datos de la tarea desde la URL o almacenamiento
    function loadTaskData() {
      const urlParams = new URLSearchParams(window.location.hash.split('?')[1]);
      const taskId = urlParams.get('id');
      
      if (taskId) {
        // Aqu√≠ cargar√≠as los datos de la tarea desde tu API
        // Por ahora usamos datos de ejemplo
        const taskData = {
          titulo: 'Tarea de ejemplo',
          descripcion: 'Esta es una descripci√≥n de ejemplo',
          fechaLimite: '2024-12-31',
          prioridad: 'media',
          estado: 'en-progreso'
        };
        
        // Llenar el formulario con los datos
        fillForm(taskData);
      }
    }

    // Llenar formulario con datos
    function fillForm(data) {
      document.getElementById('titulo').value = data.titulo || '';
      document.getElementById('descripcion').value = data.descripcion || '';
      document.getElementById('fechaLimite').value = data.fechaLimite || '';
      document.getElementById('prioridad').value = data.prioridad || 'baja';
      document.getElementById('estado').value = data.estado || 'nuevo';
    }

    // Manejar env√≠o del formulario
    async function handleFormSubmit(e) {
      e.preventDefault();
      
      const formData = new FormData(e.target);
      const taskData = {
        titulo: formData.get('titulo'),
        descripcion: formData.get('descripcion'),
        fechaLimite: formData.get('fechaLimite'),
        prioridad: formData.get('prioridad'),
        estado: formData.get('estado')
      };

      showMessage('Guardando cambios...', 'info');
      
      try {
        // Aqu√≠ har√≠as la petici√≥n a tu API para actualizar la tarea
        // await updateTask(taskId, taskData);
        
        // Simular delay de API
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        showMessage('‚úÖ Tarea actualizada correctamente', 'success');
        
        // Redirigir de vuelta a las tareas despu√©s de 2 segundos
        setTimeout(() => {
          window.location.hash = '#/tasks';
        }, 2000);
        
      } catch (error) {
        console.error('Error:', error);
        showMessage('‚ùå Error al actualizar la tarea', 'error');
      }
    }

    // Mostrar mensajes
    function showMessage(text, type) {
      const message = document.getElementById('edit-task-message');
      message.textContent = text;
      message.className = `form-message ${type}`;
      message.style.display = 'block';
      
      if (type === 'info') {
        // Ocultar mensaje de info despu√©s de 3 segundos
        setTimeout(() => {
          if (message.className.includes('info')) {
            message.style.display = 'none';
          }
        }, 3000);
      }
    }

    // Configurar navbar responsivo
    function setupNavbar() {
      const navToggle = document.getElementById('nav-toggle');
      const navContent = document.getElementById('nav-content');

      if (navToggle && navContent) {
        navToggle.addEventListener('click', () => {
          navContent.classList.toggle('active');
          navToggle.classList.toggle('open');
        });

        // Cerrar men√∫ al hacer clic en un enlace
        navContent.querySelectorAll('a').forEach(link => {
          link.addEventListener('click', () => {
            navContent.classList.remove('active');
            navToggle.classList.remove('open');
          });
        });
      }
    }
  </script>
</body>
</html> 